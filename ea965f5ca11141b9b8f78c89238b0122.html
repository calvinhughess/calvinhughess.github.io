<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>0c31ff2f5ace4df08f813c43a0565d1c</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<section
id="analyzing-player-impact-in-the-uefa-champions-league-2021-2022-a-data-driven-approach"
class="cell markdown">
<h1>Analyzing Player Impact in the UEFA Champions League 2021-2022: A
Data-Driven Approach</h1>
<h2 id="introduction">Introduction</h2>
<p>Welcome to our comprehensive tutorial where we delve into the
fascinating world of football analytics, focusing specifically on the
UEFA Champions League 2021-2022 season. The Champions League, known for
its high stakes and intensely competitive matches, offers a unique
dataset to analyze and understand the intricacies of player performance
at the highest level of club football.</p>
<p>In this tutorial, we will explore a dataset that captures a wide
range of player statistics, from goal-scoring prowess and defensive
solidity to distribution efficiency and disciplinary records. Each CSV
file in our dataset—ranging from <code>attacking.csv</code> to
<code>goals.csv</code> and beyond—provides detailed insights into
different aspects of the game, allowing us to paint a comprehensive
picture of what makes a player, or a team, stand out in one of the most
prestigious tournaments in the world.</p>
<p>The objective of this analysis is not just to identify who the top
performers are but to understand the underlying factors that contribute
to successful performances in the Champions League. By employing a
variety of data science techniques, from basic exploratory data analysis
to advanced predictive modeling, I aim to uncover the subtle nuances
that influence game outcomes and player impacts.</p>
<p>This tutorial will provide you with an understanding of how
data-driven insights can be extracted from complex datasets. You will
learn how to clean and prepare data, perform detailed statistical
analysis, and develop predictive models that can forecast player
performance.</p>
<p>As we progress, keep in mind that the tools and techniques discussed
here are not only applicable to football or sports analytics but can be
adapted to a wide range of domains where performance analysis is
required.</p>
<p>We will begin by parsing through the csv files we are given.</p>
</section>
<div class="cell code" data-execution_count="740">
<div class="sourceCode" id="cb1"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>directory <span class="op">=</span> <span class="st">&#39;archive&#39;</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co"># list all CSV files in the directory</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>csv_files <span class="op">=</span> [f <span class="cf">for</span> f <span class="kw">in</span> os.listdir(directory) <span class="cf">if</span> f.endswith(<span class="st">&#39;.csv&#39;</span>)]</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co"># loop through each file and print their column names</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> <span class="bu">file</span> <span class="kw">in</span> csv_files:</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>    file_path <span class="op">=</span> os.path.join(directory, <span class="bu">file</span>)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> pd.read_csv(file_path)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;Columns in </span><span class="sc">{</span><span class="bu">file</span><span class="sc">}</span><span class="ss">:&quot;</span>)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(df.columns.tolist())  <span class="co"># prints list of columns in the CSV file</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)  <span class="co"># adds a newline for better readability between files</span></span></code></pre></div>
<div class="output stream stdout">
<pre><code>Columns in attacking.csv:
[&#39;serial&#39;, &#39;player_name&#39;, &#39;club&#39;, &#39;position&#39;, &#39;assists&#39;, &#39;corner_taken&#39;, &#39;offsides&#39;, &#39;dribbles&#39;, &#39;match_played&#39;]


Columns in attempts.csv:
[&#39;serial&#39;, &#39;player_name&#39;, &#39;club&#39;, &#39;position&#39;, &#39;total_attempts&#39;, &#39;on_target&#39;, &#39;off_target&#39;, &#39;blocked&#39;, &#39;match_played&#39;]


Columns in defending.csv:
[&#39;serial&#39;, &#39;player_name&#39;, &#39;club&#39;, &#39;position&#39;, &#39;balls_recoverd&#39;, &#39;tackles&#39;, &#39;t_won&#39;, &#39;t_lost&#39;, &#39;clearance_attempted&#39;, &#39;match_played&#39;]


Columns in disciplinary.csv:
[&#39;serial&#39;, &#39;player_name&#39;, &#39;club&#39;, &#39;position&#39;, &#39;fouls_committed&#39;, &#39;fouls_suffered&#39;, &#39;red&#39;, &#39;yellow&#39;, &#39;minutes_played&#39;, &#39;match_played&#39;]


Columns in distributon.csv:
[&#39;serial&#39;, &#39;player_name&#39;, &#39;club&#39;, &#39;position&#39;, &#39;pass_accuracy&#39;, &#39;pass_attempted&#39;, &#39;pass_completed&#39;, &#39;cross_accuracy&#39;, &#39;cross_attempted&#39;, &#39;cross_complted&#39;, &#39;freekicks_taken&#39;, &#39;match_played&#39;]


Columns in goalkeeping.csv:
[&#39;serial&#39;, &#39;player_name&#39;, &#39;club&#39;, &#39;position&#39;, &#39;saved&#39;, &#39;conceded&#39;, &#39;saved_penalties&#39;, &#39;cleansheets&#39;, &#39;punches made&#39;, &#39;match_played&#39;]


Columns in goals.csv:
[&#39;serial&#39;, &#39;player_name&#39;, &#39;club&#39;, &#39;position&#39;, &#39;goals&#39;, &#39;right_foot&#39;, &#39;left_foot&#39;, &#39;headers&#39;, &#39;others&#39;, &#39;inside_area&#39;, &#39;outside_areas&#39;, &#39;penalties&#39;, &#39;match_played&#39;]


Columns in key_stats.csv:
[&#39;player_name&#39;, &#39;club&#39;, &#39;position&#39;, &#39;minutes_played&#39;, &#39;match_played&#39;, &#39;goals&#39;, &#39;assists&#39;, &#39;distance_covered&#39;]


</code></pre>
</div>
</div>
<section id="data-collection" class="cell markdown">
<h2>Data Collection</h2>
<h3 id="overview">Overview</h3>
<p>In this project, we aim to analyze the impact of players in the UEFA
Champions League 2021-2022 season by exploring a comprehensive dataset
that includes various performance metrics across multiple aspects of the
game. This dataset is organized into several CSV files, each focusing on
different areas such as attacking, defending, goalkeeping, and more. Our
first task is to collect and prepare this data for in-depth
analysis.</p>
<h3 id="data-sources">Data Sources</h3>
<p>The dataset is divided into eight CSV files, each providing unique
insights into player performances:</p>
<ol>
<li><strong>Attacking.csv</strong>: Contains data on player assists,
corners taken, offsides, and dribbles.</li>
<li><strong>Attempts.csv</strong>: Details total attempts on goal,
including shots on target, off target, and blocked shots.</li>
<li><strong>Defending.csv</strong>: Offers statistics on balls
recovered, tackles made, tackles won, tackles lost, and attempted
clearances.</li>
<li><strong>Disciplinary.csv</strong>: Records disciplinary actions,
including fouls committed, fouls suffered, red cards, and yellow
cards.</li>
<li><strong>Distributon.csv</strong>: Focuses on passing and crossing
accuracy, including total passes attempted, completed, and the accuracy
of crosses.</li>
<li><strong>Goalkeeping.csv</strong>: Provides data on goalkeeper
performances, such as saves made, goals conceded, penalties saved, and
clean sheets.</li>
<li><strong>Goals.csv</strong>: Tracks the details of goals scored,
including the foot used, headers, and penalties.</li>
<li><strong>Key_Stats.csv</strong>: A summary file that includes overall
minutes played, matches played, goals, assists, and distance
covered.</li>
</ol>
<h3 id="data-retrieval-process">Data Retrieval Process</h3>
<p>To begin our analysis, we will first retrieve and load this data into
our Python environment using pandas, a powerful data manipulation
library. Here's how we can load each file and take a preliminary look at
its contents:</p>
</section>
<div class="cell code" data-execution_count="741">
<div class="sourceCode" id="cb3"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co"># define the path to the archive directory</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>archive_dir <span class="op">=</span> <span class="st">&#39;archive/&#39;</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Load each dataset</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>attacking <span class="op">=</span> pd.read_csv(<span class="ss">f&#39;</span><span class="sc">{</span>archive_dir<span class="sc">}</span><span class="ss">attacking.csv&#39;</span>)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>attempts <span class="op">=</span> pd.read_csv(<span class="ss">f&#39;</span><span class="sc">{</span>archive_dir<span class="sc">}</span><span class="ss">attempts.csv&#39;</span>)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>defending <span class="op">=</span> pd.read_csv(<span class="ss">f&#39;</span><span class="sc">{</span>archive_dir<span class="sc">}</span><span class="ss">defending.csv&#39;</span>)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>disciplinary <span class="op">=</span> pd.read_csv(<span class="ss">f&#39;</span><span class="sc">{</span>archive_dir<span class="sc">}</span><span class="ss">disciplinary.csv&#39;</span>)</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>distribution <span class="op">=</span> pd.read_csv(<span class="ss">f&#39;</span><span class="sc">{</span>archive_dir<span class="sc">}</span><span class="ss">distributon.csv&#39;</span>)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>goalkeeping <span class="op">=</span> pd.read_csv(<span class="ss">f&#39;</span><span class="sc">{</span>archive_dir<span class="sc">}</span><span class="ss">goalkeeping.csv&#39;</span>)</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>goals <span class="op">=</span> pd.read_csv(<span class="ss">f&#39;</span><span class="sc">{</span>archive_dir<span class="sc">}</span><span class="ss">goals.csv&#39;</span>)</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>key_stats <span class="op">=</span> pd.read_csv(<span class="ss">f&#39;</span><span class="sc">{</span>archive_dir<span class="sc">}</span><span class="ss">key_stats.csv&#39;</span>)</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="co"># display the first few rows of the attacking data</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;First few rows of Attacking data:&quot;</span>)</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(attacking.head())</span></code></pre></div>
<div class="output stream stdout">
<pre><code>First few rows of Attacking data:
   serial       player_name         club    position  assists  corner_taken  \
0       1   Bruno Fernandes  Man. United  Midfielder        7            10   
1       2   Vinícius Júnior  Real Madrid     Forward        6             3   
2       2              Sané       Bayern  Midfielder        6             3   
3       4            Antony         Ajax     Forward        5             3   
4       5  Alexander-Arnold    Liverpool    Defender        4            36   

   offsides  dribbles  match_played  
0         2         7             7  
1         4        83            13  
2         3        32            10  
3         4        28             7  
4         0         9             9  
</code></pre>
</div>
</div>
<div class="cell markdown">
<h3 id="initial-data-review">Initial Data Review</h3>
<p>Upon loading the data, conduct an initial review to check for:</p>
<ul>
<li><strong>Consistency in data formats</strong>: Ensure that all data
types are correctly identified, such as integers for counts and floats
for percentages.</li>
<li><strong>Missing values</strong>: Identify if any key data points are
missing and require imputation or removal.</li>
<li><strong>Preliminary insights</strong>: Note any interesting trends
or anomalies that could warrant deeper investigation.</li>
</ul>
<h3 id="conclusion">Conclusion</h3>
<p>Collecting and initially reviewing this data will set the foundation
for our exploratory data analysis. Understanding the structure and
quality of our data is crucial before moving forward with more detailed
statistical analysis or predictive modeling.</p>
</div>
<section id="data-processing" class="cell markdown">
<h2>Data Processing</h2>
<h3 id="overview">Overview</h3>
<p>To analyze player impact effectively, we first need to prepare our
dataset, which consists of multiple CSV files located in the 'archive'
directory. We'll combine these files into a comprehensive DataFrame,
clean the data, and ensure it's correctly formatted for subsequent
analysis.</p>
<h3 id="libraries-and-documentation">Libraries and Documentation</h3>
<p>For data manipulation, we'll use Pandas and NumPy, essential
libraries in Python's data science stack:</p>
<ul>
<li><strong>Pandas</strong>: <a
href="https://pandas.pydata.org/docs/index.html">Pandas
Documentation</a></li>
<li><strong>NumPy</strong>: <a
href="https://numpy.org/doc/stable/index.html">NumPy
Documentation</a></li>
</ul>
<h3 id="initial-data-loading">Initial Data Loading</h3>
<p>Each CSV file represents a different aspect of player performance.
We'll load these into separate DataFrames before merging them into a
master DataFrame.</p>
</section>
<div class="cell code" data-execution_count="742">
<div class="sourceCode" id="cb5"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the path to the archive directory</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>archive_dir <span class="op">=</span> <span class="st">&#39;archive/&#39;</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Load each dataset</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>data_files <span class="op">=</span> [<span class="st">&#39;attacking&#39;</span>, <span class="st">&#39;attempts&#39;</span>, <span class="st">&#39;defending&#39;</span>, <span class="st">&#39;disciplinary&#39;</span>, <span class="st">&#39;distributon&#39;</span>, <span class="st">&#39;goalkeeping&#39;</span>, <span class="st">&#39;goals&#39;</span>, <span class="st">&#39;key_stats&#39;</span>]</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>data_frames <span class="op">=</span> {<span class="bu">file</span>: pd.read_csv(<span class="ss">f&#39;</span><span class="sc">{</span>archive_dir<span class="sc">}</span><span class="ss">/</span><span class="sc">{</span><span class="bu">file</span><span class="sc">}</span><span class="ss">.csv&#39;</span>) <span class="cf">for</span> <span class="bu">file</span> <span class="kw">in</span> data_files}</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the first few rows of each DataFrame to verify</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> name, frame <span class="kw">in</span> data_frames.items():</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;First few rows of </span><span class="sc">{</span>name<span class="sc">.</span>capitalize()<span class="sc">}</span><span class="ss"> data:&quot;</span>)</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(frame.head(), <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>First few rows of Attacking data:
   serial       player_name         club    position  assists  corner_taken  \
0       1   Bruno Fernandes  Man. United  Midfielder        7            10   
1       2   Vinícius Júnior  Real Madrid     Forward        6             3   
2       2              Sané       Bayern  Midfielder        6             3   
3       4            Antony         Ajax     Forward        5             3   
4       5  Alexander-Arnold    Liverpool    Defender        4            36   

   offsides  dribbles  match_played  
0         2         7             7  
1         4        83            13  
2         3        32            10  
3         4        28             7  
4         0         9             9   

First few rows of Attempts data:
   serial  player_name         club    position  total_attempts  on_target  \
0       1      Benzema  Real Madrid     Forward              45         23   
1       2        Salah    Liverpool     Forward              42         22   
2       3       Mahrez    Man. City  Midfielder              37         18   
3       4         Sané       Bayern  Midfielder              33         13   
4       5  Lewandowski       Bayern     Forward              31         19   

   off_target  blocked  match_played  
0          13        9            12  
1          11        9            13  
2           8       11            12  
3          12        8            10  
4           8        4            10   

First few rows of Defending data:
   serial   player_name         club    position  balls_recoverd  tackles  \
0       1      Casemiro  Real Madrid  Midfielder              76       31   
1       1  Éder Militão  Real Madrid    Defender              76       19   
2       1      Reinildo     Atlético    Defender              76       13   
3       4       Fabinho    Liverpool  Midfielder              74       23   
4       5        Albiol   Villarreal    Defender              73        9   

   t_won  t_lost  clearance_attempted  match_played  
0     13      18                   19            11  
1      6      13                   32            12  
2      6       7                   20            10  
3      9      14                    8            13  
4      6       3                   62            12   

First few rows of Disciplinary data:
   serial    player_name         club    position  fouls_committed  \
0       1  João Palhinha  Sporting CP  Midfielder               23   
1       2         Capoue   Villarreal  Midfielder               19   
2       2          Rodri    Man. City  Midfielder               19   
3       2        Seiwald     Salzburg  Midfielder               19   
4       5        Balanta  Club Brugge  Midfielder               18   

   fouls_suffered  red  yellow  minutes_played  match_played  
0              17    2       0             534             6  
1              17    3       1            1046            12  
2               4    2       0             842            10  
3               3    2       0             649             8  
4               3    4       0             407             5   

First few rows of Distributon data:
   serial  player_name       club    position  pass_accuracy  pass_attempted  \
0       1      Erokhin      Zenit  Midfielder           98.0              27   
1       2  Eric García  Barcelona    Defender           97.5             203   
2       3      Ulreich     Bayern  Goalkeeper           97.0              32   
3       4       Rugani   Juventus    Defender           96.8             130   
4       5    J. Timber       Ajax  Midfielder           95.8             497   

   pass_completed  cross_accuracy  cross_attempted  cross_complted  \
0              26               0                2               0   
1             197               0                0               0   
2              31               0                0               0   
3             122               0                0               0   
4             474               0                1               0   

   freekicks_taken  match_played  
0                0             6  
1                1             4  
2                1             1  
3                0             4  
4               14             8   

First few rows of Goalkeeping data:
   serial   player_name         club    position  saved  conceded  \
0       1      Courtois  Real Madrid  Goalkeeper     61        14   
1       2         Rulli   Villarreal  Goalkeeper     41        16   
2       3   Vlachodimos      Benfica  Goalkeeper     38        17   
3       4  Athanasiadis      Sheriff  Goalkeeper     29         8   
4       5      Mignolet  Club Brugge  Goalkeeper     28        20   

   saved_penalties  cleansheets  punches made  match_played  
0                1            5             4            13  
1                0            3            12            12  
2                1            5             5            10  
3                0            1             2             5  
4                0            0             1             6   

First few rows of Goals data:
   serial  player_name         club    position  goals  right_foot  left_foot  \
0       1      Benzema  Real Madrid     Forward     15          11          1   
1       2  Lewandowski       Bayern     Forward     13           8          3   
2       3       Haller         Ajax     Forward     11           3          4   
3       4        Salah    Liverpool     Forward      8           0          8   
4       5       Nkunku      Leipzig  Midfielder      7           3          1   

   headers  others  inside_area  outside_areas  penalties  match_played  
0        3       0           13              2          3            12  
1        1       1           13              0          3            10  
2        3       1           11              0          1             8  
3        0       0            7              1          1            13  
4        3       0            7              0          0             6   

First few rows of Key_stats data:
       player_name         club    position  minutes_played  match_played  \
0         Courtois  Real Madrid  Goalkeeper            1230            13   
1  Vinícius Júnior  Real Madrid     Forward            1199            13   
2          Benzema  Real Madrid     Forward            1106            12   
3           Modrić  Real Madrid  Midfielder            1077            13   
4     Éder Militão  Real Madrid    Defender            1076            12   

   goals  assists distance_covered  
0      0        0             64.2  
1      4        6            133.0  
2     15        1            121.5  
3      0        4            124.5  
4      0        0            110.4   

</code></pre>
</div>
</div>
<section id="data-cleaning-and-merging" class="cell markdown">
<h3>Data Cleaning and Merging</h3>
<p>Our next step is to clean each DataFrame and merge them into a single
DataFrame for a unified analysis base.</p>
<h4 id="merging-strategy">Merging Strategy</h4>
<p>We'll merge all DataFrames on common columns such as 'player_name',
'club', and 'match_played'. This approach assumes that each player's
entry across different files corresponds to the same match
instances.</p>
<h4 id="dropping-unnecessary-columns">Dropping Unnecessary Columns</h4>
<p>The 'serial' column, present in some files, does not contribute to
our analysis and will be removed.</p>
</section>
<div class="cell code" data-execution_count="743">
<div class="sourceCode" id="cb7"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># remove &#39;serial&#39; column from each DataFrame, if present</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> name, frame <span class="kw">in</span> data_frames.items():</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="st">&#39;serial&#39;</span> <span class="kw">in</span> frame.columns:</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>        frame.drop(columns<span class="op">=</span>[<span class="st">&#39;serial&#39;</span>], inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;Dropped &#39;serial&#39; from </span><span class="sc">{</span>name<span class="sc">}</span><span class="ss">.&quot;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Dropped &#39;serial&#39; from attacking.
Dropped &#39;serial&#39; from attempts.
Dropped &#39;serial&#39; from defending.
Dropped &#39;serial&#39; from disciplinary.
Dropped &#39;serial&#39; from distributon.
Dropped &#39;serial&#39; from goalkeeping.
Dropped &#39;serial&#39; from goals.
</code></pre>
</div>
</div>
<section id="step-3-merging-dataframes" class="cell markdown">
<h3>Step 3: Merging DataFrames</h3>
<p>With the individual DataFrames cleaned, we'll merge them into a
single DataFrame. This is crucial for performing holistic analyses
across multiple performance metrics.</p>
</section>
<div class="cell code" data-execution_count="744">
<div class="sourceCode" id="cb9"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> functools <span class="im">import</span> <span class="bu">reduce</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co"># merge all DataFrames on common keys</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> merge_dataframes(df_list):</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">reduce</span>(<span class="kw">lambda</span> left, right: pd.merge(left, right, on<span class="op">=</span>[<span class="st">&#39;player_name&#39;</span>, <span class="st">&#39;club&#39;</span>, <span class="st">&#39;position&#39;</span>, <span class="st">&#39;match_played&#39;</span>], how<span class="op">=</span><span class="st">&#39;outer&#39;</span>), df_list)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>master_df <span class="op">=</span> merge_dataframes(<span class="bu">list</span>(data_frames.values()))</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Master DataFrame shape:&quot;</span>, master_df.shape)</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(master_df.head())</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Master DataFrame shape: (755, 46)
  player_name      club    position  assists_x  corner_taken  offsides  \
0    Aaronson  Salzburg  Midfielder        2.0           4.0       5.0   
1   Abubakari     Malmö     Forward        NaN           NaN       NaN   
2       Acuña   Sevilla    Defender        NaN           NaN       NaN   
3       Adams   Leipzig  Midfielder        NaN           NaN       NaN   
4       Adamu  Salzburg     Forward        NaN           NaN       NaN   

   dribbles  match_played  total_attempts  on_target  ...  left_foot  headers  \
0       9.0             8             9.0        3.0  ...        NaN      NaN   
1       NaN             4             2.0        0.0  ...        NaN      NaN   
2       NaN             5             NaN        NaN  ...        NaN      NaN   
3       NaN             5             NaN        NaN  ...        NaN      NaN   
4       NaN             8             4.0        2.0  ...        0.0      0.0   

   others  inside_area  outside_areas  penalties  minutes_played_y  goals_y  \
0     NaN          NaN            NaN        NaN             715.0      0.0   
1     NaN          NaN            NaN        NaN             116.0      0.0   
2     NaN          NaN            NaN        NaN             379.0      0.0   
3     NaN          NaN            NaN        NaN             292.0      0.0   
4     0.0          1.0            0.0        0.0             231.0      1.0   

   assists_y  distance_covered  
0        2.0             103.5  
1        0.0              15.3  
2        0.0              43.2  
3        0.0              38.9  
4        0.0              32.6  

[5 rows x 46 columns]
</code></pre>
</div>
</div>
<div class="cell markdown">
<p>There are duplicate columns present in the DataFrame that may cause
problems for analysis, so we must deal with them.</p>
<h4 id="step-1-identify-duplicate-columns">Step 1: Identify Duplicate
Columns</h4>
<p>First, the identified duplicated columns are labeled with suffixes
with _x and _y. We must select one from each pair (usually _x or _y
would contain identical data if they are indeed duplicates).</p>
<h4 id="step-2-drop-redundant-columns">Step 2: Drop Redundant
Columns</h4>
<p>Since the data in these columns are identical, you can safely drop
one of each pair without losing information.</p>
<h4 id="step-3-rename-remaining-columns">Step 3: Rename Remaining
Columns</h4>
<p>After removing the redundant columns, rename the remaining columns to
remove any suffixes like _x or _y, giving them clearer names.</p>
</div>
<div class="cell code" data-execution_count="745">
<div class="sourceCode" id="cb11"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co"># columns identified as duplicates and their preferred names</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>duplicate_columns_to_rename <span class="op">=</span> {</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;assists_x&#39;</span>: <span class="st">&#39;assists&#39;</span>,</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;goals_x&#39;</span>: <span class="st">&#39;goals&#39;</span>,</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;minutes_played_x&#39;</span>: <span class="st">&#39;minutes_played&#39;</span>,</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="co"># drop the redundant columns</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>columns_to_drop <span class="op">=</span> [key.replace(<span class="st">&#39;_x&#39;</span>, <span class="st">&#39;_y&#39;</span>) <span class="cf">for</span> key <span class="kw">in</span> duplicate_columns_to_rename.keys()]</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>master_df.drop(columns<span class="op">=</span>columns_to_drop, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a><span class="co"># rename the remaining columns to remove suffixes</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>master_df.rename(columns<span class="op">=</span>duplicate_columns_to_rename, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a><span class="co"># verify changes</span></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(master_df.head())</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(master_df.columns)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>  player_name      club    position  assists  corner_taken  offsides  \
0    Aaronson  Salzburg  Midfielder      2.0           4.0       5.0   
1   Abubakari     Malmö     Forward      NaN           NaN       NaN   
2       Acuña   Sevilla    Defender      NaN           NaN       NaN   
3       Adams   Leipzig  Midfielder      NaN           NaN       NaN   
4       Adamu  Salzburg     Forward      NaN           NaN       NaN   

   dribbles  match_played  total_attempts  on_target  ...  punches made  \
0       9.0             8             9.0        3.0  ...           NaN   
1       NaN             4             2.0        0.0  ...           NaN   
2       NaN             5             NaN        NaN  ...           NaN   
3       NaN             5             NaN        NaN  ...           NaN   
4       NaN             8             4.0        2.0  ...           NaN   

   goals  right_foot  left_foot  headers  others  inside_area  outside_areas  \
0    NaN         NaN        NaN      NaN     NaN          NaN            NaN   
1    NaN         NaN        NaN      NaN     NaN          NaN            NaN   
2    NaN         NaN        NaN      NaN     NaN          NaN            NaN   
3    NaN         NaN        NaN      NaN     NaN          NaN            NaN   
4    1.0         1.0        0.0      0.0     0.0          1.0            0.0   

   penalties  distance_covered  
0        NaN             103.5  
1        NaN              15.3  
2        NaN              43.2  
3        NaN              38.9  
4        0.0              32.6  

[5 rows x 43 columns]
Index([&#39;player_name&#39;, &#39;club&#39;, &#39;position&#39;, &#39;assists&#39;, &#39;corner_taken&#39;,
       &#39;offsides&#39;, &#39;dribbles&#39;, &#39;match_played&#39;, &#39;total_attempts&#39;, &#39;on_target&#39;,
       &#39;off_target&#39;, &#39;blocked&#39;, &#39;balls_recoverd&#39;, &#39;tackles&#39;, &#39;t_won&#39;, &#39;t_lost&#39;,
       &#39;clearance_attempted&#39;, &#39;fouls_committed&#39;, &#39;fouls_suffered&#39;, &#39;red&#39;,
       &#39;yellow&#39;, &#39;minutes_played&#39;, &#39;pass_accuracy&#39;, &#39;pass_attempted&#39;,
       &#39;pass_completed&#39;, &#39;cross_accuracy&#39;, &#39;cross_attempted&#39;, &#39;cross_complted&#39;,
       &#39;freekicks_taken&#39;, &#39;saved&#39;, &#39;conceded&#39;, &#39;saved_penalties&#39;,
       &#39;cleansheets&#39;, &#39;punches made&#39;, &#39;goals&#39;, &#39;right_foot&#39;, &#39;left_foot&#39;,
       &#39;headers&#39;, &#39;others&#39;, &#39;inside_area&#39;, &#39;outside_areas&#39;, &#39;penalties&#39;,
       &#39;distance_covered&#39;],
      dtype=&#39;object&#39;)
</code></pre>
</div>
</div>
<section id="data-validation" class="cell markdown">
<h3>Data Validation</h3>
<p>After cleaning, validate the data to ensure accuracy and readiness
for analysis.</p>
<ul>
<li><strong>Check for Duplicates</strong>: Ensure no unintended
duplicates.</li>
<li><strong>Summary Statistics</strong>: Use <code>.describe()</code> to
get an overview and spot any anomalies.</li>
</ul>
</section>
<div class="cell code" data-execution_count="746">
<div class="sourceCode" id="cb13"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># remove any remaining duplicates</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>master_df.drop_duplicates(inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co"># check for and handle missing values</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(master_df.isnull().<span class="bu">sum</span>())</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="co"># ensure all data types are correct for analysis</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(master_df.dtypes)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>player_name              0
club                     0
position                 0
assists                579
corner_taken           579
offsides               579
dribbles               579
match_played             0
total_attempts         209
on_target              209
off_target             209
blocked                209
balls_recoverd         128
tackles                128
t_won                  128
t_lost                 128
clearance_attempted    128
fouls_committed        171
fouls_suffered         171
red                    171
yellow                 171
minutes_played         171
pass_accuracy          147
pass_attempted         147
pass_completed         147
cross_accuracy         147
cross_attempted        147
cross_complted         147
freekicks_taken        147
saved                  702
conceded               702
saved_penalties        702
cleansheets            702
punches made           702
goals                  572
right_foot             572
left_foot              572
headers                572
others                 572
inside_area            572
outside_areas          572
penalties              572
distance_covered         8
dtype: int64
player_name             object
club                    object
position                object
assists                float64
corner_taken           float64
offsides               float64
dribbles               float64
match_played             int64
total_attempts         float64
on_target              float64
off_target             float64
blocked                float64
balls_recoverd         float64
tackles                float64
t_won                  float64
t_lost                 float64
clearance_attempted    float64
fouls_committed        float64
fouls_suffered         float64
red                    float64
yellow                 float64
minutes_played         float64
pass_accuracy          float64
pass_attempted         float64
pass_completed         float64
cross_accuracy         float64
cross_attempted        float64
cross_complted         float64
freekicks_taken        float64
saved                  float64
conceded               float64
saved_penalties        float64
cleansheets            float64
punches made           float64
goals                  float64
right_foot             float64
left_foot              float64
headers                float64
others                 float64
inside_area            float64
outside_areas          float64
penalties              float64
distance_covered        object
dtype: object
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="747">
<div class="sourceCode" id="cb15"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="co"># assume that total_attempts should at least be equal to the sum of all types of goals if it&#39;s lower</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>master_df[<span class="st">&#39;total_attempts&#39;</span>] <span class="op">=</span> master_df.<span class="bu">apply</span>(</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">lambda</span> x: <span class="bu">max</span>(x[<span class="st">&#39;total_attempts&#39;</span>], x[<span class="st">&#39;goals&#39;</span>], x[<span class="st">&#39;right_foot&#39;</span>] <span class="op">+</span> x[<span class="st">&#39;left_foot&#39;</span>] <span class="op">+</span> x[<span class="st">&#39;headers&#39;</span>] <span class="op">+</span> x[<span class="st">&#39;others&#39;</span>]),</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>    axis<span class="op">=</span><span class="dv">1</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="co"># ensure that specific goal types do not exceed total goals</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>goal_types <span class="op">=</span> [<span class="st">&#39;right_foot&#39;</span>, <span class="st">&#39;left_foot&#39;</span>, <span class="st">&#39;headers&#39;</span>, <span class="st">&#39;others&#39;</span>]</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> goal_type <span class="kw">in</span> goal_types:</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>    master_df[goal_type] <span class="op">=</span> master_df.<span class="bu">apply</span>(</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>        <span class="kw">lambda</span> x: <span class="bu">min</span>(x[goal_type], x[<span class="st">&#39;goals&#39;</span>]) <span class="cf">if</span> x[goal_type] <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">else</span> x[goal_type],</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>        axis<span class="op">=</span><span class="dv">1</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>master_df[<span class="st">&#39;goals&#39;</span>] <span class="op">=</span> master_df[goal_types].<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>master_df[<span class="st">&#39;goals&#39;</span>] <span class="op">=</span> master_df.<span class="bu">apply</span>(</span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>    <span class="kw">lambda</span> x: x[<span class="st">&#39;total_attempts&#39;</span>] <span class="cf">if</span> x[<span class="st">&#39;goals&#39;</span>] <span class="op">&gt;</span> x[<span class="st">&#39;total_attempts&#39;</span>] <span class="cf">else</span> x[<span class="st">&#39;goals&#39;</span>],</span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>    axis<span class="op">=</span><span class="dv">1</span></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a><span class="co"># exclude players who have goals but zero total attempts</span></span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>master_df <span class="op">=</span> master_df[<span class="op">~</span>((master_df[<span class="st">&#39;goals&#39;</span>] <span class="op">&gt;</span> <span class="dv">0</span>) <span class="op">&amp;</span> (master_df[<span class="st">&#39;total_attempts&#39;</span>] <span class="op">==</span> <span class="dv">0</span>))]</span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a><span class="co"># convert &#39;minutes_played&#39; to numeric</span></span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>master_df[<span class="st">&#39;minutes_played&#39;</span>] <span class="op">=</span> pd.to_numeric(master_df[<span class="st">&#39;minutes_played&#39;</span>], errors<span class="op">=</span><span class="st">&#39;coerce&#39;</span>)</span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>master_df[<span class="st">&#39;distance_covered&#39;</span>] <span class="op">=</span> pd.to_numeric(master_df[<span class="st">&#39;distance_covered&#39;</span>], errors<span class="op">=</span><span class="st">&#39;coerce&#39;</span>)</span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a><span class="co"># filter out players with distance covered but no minutes played</span></span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a>master_df <span class="op">=</span> master_df[<span class="op">~</span>((master_df[<span class="st">&#39;distance_covered&#39;</span>] <span class="op">&gt;</span> <span class="dv">0</span>) <span class="op">&amp;</span> (master_df[<span class="st">&#39;minutes_played&#39;</span>].isna() <span class="op">|</span> (master_df[<span class="st">&#39;minutes_played&#39;</span>] <span class="op">==</span> <span class="dv">0</span>)))]</span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-36"><a href="#cb15-36" aria-hidden="true" tabindex="-1"></a>master_df.fillna(<span class="dv">0</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb15-37"><a href="#cb15-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-38"><a href="#cb15-38" aria-hidden="true" tabindex="-1"></a><span class="co"># recheck the first few rows to ensure corrections</span></span>
<span id="cb15-39"><a href="#cb15-39" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(master_df[[<span class="st">&#39;player_name&#39;</span>, <span class="st">&#39;total_attempts&#39;</span>, <span class="st">&#39;goals&#39;</span>, <span class="st">&#39;right_foot&#39;</span>, <span class="st">&#39;left_foot&#39;</span>, <span class="st">&#39;headers&#39;</span>, <span class="st">&#39;others&#39;</span>]].head())</span></code></pre></div>
<div class="output stream stdout">
<pre><code>  player_name  total_attempts  goals  right_foot  left_foot  headers  others
0    Aaronson             9.0    0.0         0.0        0.0      0.0     0.0
1   Abubakari             2.0    0.0         0.0        0.0      0.0     0.0
2       Acuña             0.0    0.0         0.0        0.0      0.0     0.0
3       Adams             0.0    0.0         0.0        0.0      0.0     0.0
4       Adamu             4.0    1.0         1.0        0.0      0.0     0.0
</code></pre>
</div>
</div>
<section id="conclusion" class="cell markdown">
<h3>Conclusion</h3>
<p>The data is now cleaned and consolidated into a single DataFrame,
making it easier and more efficient to conduct comprehensive analyses on
player performances throughout the Champions League season. This step
sets the foundation for exploratory data analysis and further
statistical modeling.</p>
</section>
<section id="eda-exploratory-data-analysis" class="cell markdown">
<h2>EDA (Exploratory Data Analysis)</h2>
<h3 id="overview">Overview</h3>
<p>In this section, we conduct a preliminary examination of the UEFA
Champions League 2021-2022 player dataset. The dataset comprises several
attributes related to player performance in matches throughout the
season, including offensive, defensive, and disciplinary statistics.</p>
<h3 id="data-inspection">Data Inspection</h3>
<p>The dataset includes details from multiple related files such as
attacking.csv, defending.csv, and goals.csv, among others. These files
provide a comprehensive view of each player's contributions and
performances across different aspects of the game.</p>
</section>
<div class="cell code" data-execution_count="748">
<div class="sourceCode" id="cb17"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># display the first few rows of the DataFrame</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(master_df.head())</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co"># summary statistics and information</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(master_df.describe())</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(master_df.info())</span></code></pre></div>
<div class="output stream stdout">
<pre><code>  player_name      club    position  assists  corner_taken  offsides  \
0    Aaronson  Salzburg  Midfielder      2.0           4.0       5.0   
1   Abubakari     Malmö     Forward      0.0           0.0       0.0   
2       Acuña   Sevilla    Defender      0.0           0.0       0.0   
3       Adams   Leipzig  Midfielder      0.0           0.0       0.0   
4       Adamu  Salzburg     Forward      0.0           0.0       0.0   

   dribbles  match_played  total_attempts  on_target  ...  punches made  \
0       9.0             8             9.0        3.0  ...           0.0   
1       0.0             4             2.0        0.0  ...           0.0   
2       0.0             5             0.0        0.0  ...           0.0   
3       0.0             5             0.0        0.0  ...           0.0   
4       0.0             8             4.0        2.0  ...           0.0   

   goals  right_foot  left_foot  headers  others  inside_area  outside_areas  \
0    0.0         0.0        0.0      0.0     0.0          0.0            0.0   
1    0.0         0.0        0.0      0.0     0.0          0.0            0.0   
2    0.0         0.0        0.0      0.0     0.0          0.0            0.0   
3    0.0         0.0        0.0      0.0     0.0          0.0            0.0   
4    1.0         1.0        0.0      0.0     0.0          1.0            0.0   

   penalties  distance_covered  
0        0.0             103.5  
1        0.0              15.3  
2        0.0              43.2  
3        0.0              38.9  
4        0.0              32.6  

[5 rows x 43 columns]
          assists  corner_taken    offsides    dribbles  match_played  \
count  592.000000    592.000000  592.000000  592.000000    592.000000   
mean     0.462838      0.993243    0.420608    2.646959      5.701014   
std      0.922718      3.736674    1.384143    7.342390      2.494691   
min      0.000000      0.000000    0.000000    0.000000      1.000000   
25%      0.000000      0.000000    0.000000    0.000000      4.000000   
50%      0.000000      0.000000    0.000000    0.000000      6.000000   
75%      1.000000      0.000000    0.000000    1.000000      7.000000   
max      7.000000     36.000000   10.000000   83.000000     13.000000   

       total_attempts   on_target  off_target     blocked  balls_recoverd  \
count      592.000000  592.000000  592.000000  592.000000      592.000000   
mean         5.062500    1.758446    2.013514    1.290541       16.875000   
std          6.155169    2.893033    2.321055    1.868805       14.990282   
min          0.000000    0.000000    0.000000    0.000000        0.000000   
25%          1.000000    0.000000    0.000000    0.000000        5.000000   
50%          3.000000    1.000000    1.000000    1.000000       12.000000   
75%          7.000000    2.000000    3.000000    2.000000       26.000000   
max         45.000000   23.000000   13.000000   11.000000       76.000000   

       ...  punches made       goals  right_foot   left_foot     headers  \
count  ...    592.000000  592.000000  592.000000  592.000000  592.000000   
mean   ...      0.006757    0.609797    0.288851    0.212838    0.101351   
std    ...      0.129903    1.445492    0.883776    0.709117    0.372305   
min    ...      0.000000    0.000000    0.000000    0.000000    0.000000   
25%    ...      0.000000    0.000000    0.000000    0.000000    0.000000   
50%    ...      0.000000    0.000000    0.000000    0.000000    0.000000   
75%    ...      0.000000    1.000000    0.000000    0.000000    0.000000   
max    ...      3.000000   15.000000   11.000000    8.000000    3.000000   

           others  inside_area  outside_areas   penalties  distance_covered  
count  592.000000   592.000000      592.00000  592.000000        592.000000  
mean     0.006757     0.548986        0.06250    0.060811         44.084628  
std      0.081991     1.350928        0.29858    0.318124         27.349803  
min      0.000000     0.000000        0.00000    0.000000          0.000000  
25%      0.000000     0.000000        0.00000    0.000000         23.000000  
50%      0.000000     0.000000        0.00000    0.000000         41.200000  
75%      0.000000     1.000000        0.00000    0.000000         61.400000  
max      1.000000    13.000000        3.00000    3.000000        133.000000  

[8 rows x 40 columns]
&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Index: 592 entries, 0 to 754
Data columns (total 43 columns):
 #   Column               Non-Null Count  Dtype  
---  ------               --------------  -----  
 0   player_name          592 non-null    object 
 1   club                 592 non-null    object 
 2   position             592 non-null    object 
 3   assists              592 non-null    float64
 4   corner_taken         592 non-null    float64
 5   offsides             592 non-null    float64
 6   dribbles             592 non-null    float64
 7   match_played         592 non-null    int64  
 8   total_attempts       592 non-null    float64
 9   on_target            592 non-null    float64
 10  off_target           592 non-null    float64
 11  blocked              592 non-null    float64
 12  balls_recoverd       592 non-null    float64
 13  tackles              592 non-null    float64
 14  t_won                592 non-null    float64
 15  t_lost               592 non-null    float64
 16  clearance_attempted  592 non-null    float64
 17  fouls_committed      592 non-null    float64
 18  fouls_suffered       592 non-null    float64
 19  red                  592 non-null    float64
 20  yellow               592 non-null    float64
 21  minutes_played       592 non-null    float64
 22  pass_accuracy        592 non-null    float64
 23  pass_attempted       592 non-null    float64
 24  pass_completed       592 non-null    float64
 25  cross_accuracy       592 non-null    float64
 26  cross_attempted      592 non-null    float64
 27  cross_complted       592 non-null    float64
 28  freekicks_taken      592 non-null    float64
 29  saved                592 non-null    float64
 30  conceded             592 non-null    float64
 31  saved_penalties      592 non-null    float64
 32  cleansheets          592 non-null    float64
 33  punches made         592 non-null    float64
 34  goals                592 non-null    float64
 35  right_foot           592 non-null    float64
 36  left_foot            592 non-null    float64
 37  headers              592 non-null    float64
 38  others               592 non-null    float64
 39  inside_area          592 non-null    float64
 40  outside_areas        592 non-null    float64
 41  penalties            592 non-null    float64
 42  distance_covered     592 non-null    float64
dtypes: float64(39), int64(1), object(3)
memory usage: 203.5+ KB
None
</code></pre>
</div>
</div>
<div class="cell markdown">
<p>The dataset includes numeric and categorical data types, with
specific columns for tracking detailed metrics like goals, assists,
total attempts, and defensive actions.</p>
<h3 id="data-quality-assessment">Data Quality Assessment</h3>
<p>#### Missing Values: Notable columns such as 'goals', 'assists', and
'dribbles' contain missing values. This is particularly prevalent in
players who have played fewer matches or in specific positions where
certain actions are less frequent. #### Data Types: Several columns are
identified as 'object' types due to the presence of mixed types or
missing values. These will require conversion to appropriate numeric
formats for further analysis.</p>
<h2 id="exploratory-visualizations">Exploratory Visualizations</h2>
<p>To better understand the relationships and distributions of key
variables, we employ several visualizations:</p>
<h4 id="distribution-of-goals-scored">Distribution of Goals Scored</h4>
<p>The histogram of goals scored shows a heavily right-skewed
distribution, indicating that most players score few goals, with only a
small number of players scoring a high number of goals. This pattern
suggests that goal-scoring is a rare skill, possessed by a select group
of players, which aligns with the common understanding that scoring
goals is one of the most challenging aspects of soccer.</p>
<h4 id="distribution-of-total-attempts">Distribution of Total
Attempts</h4>
<p>Similarly, the histogram for total attempts made by players is also
right-skewed but shows a more gradual decline than the goals histogram.
This indicates that while many players attempt to score, the success
rate (i.e., goals scored) does not increase linearly with the number of
attempts. This disparity emphasizes the efficiency and skill
differentials among players, where some are able to convert a higher
proportion of attempts into goals.</p>
</div>
<div class="cell code" data-execution_count="749">
<div class="sourceCode" id="cb19"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="co"># histogram of goals scored</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">5</span>))</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>sns.histplot(master_df[<span class="st">&#39;goals&#39;</span>], kde<span class="op">=</span><span class="va">True</span>)  </span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Distribution of Goals Scored&#39;</span>)</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Goals&#39;</span>)</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Frequency&#39;</span>)</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a><span class="co"># distribution of total attempts</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">5</span>))</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>sns.histplot(master_df[<span class="st">&#39;total_attempts&#39;</span>], color<span class="op">=</span><span class="st">&#39;green&#39;</span>, kde<span class="op">=</span><span class="va">True</span>)  </span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Distribution of Total Attempts&#39;</span>)</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Total Attempts&#39;</span>)</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a></span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_ea965f5ca11141b9b8f78c89238b0122/dac3d550203baef8de282156a7528526fa4aea86.png" /></p>
</div>
<div class="output display_data">
<p><img
src="vertopal_ea965f5ca11141b9b8f78c89238b0122/61c555f0bc3f09bd349e3481d7a82f2be9e76826.png" /></p>
</div>
</div>
<div class="cell markdown">
<h3 id="scatter-plot-analysis">Scatter Plot Analysis:</h3>
<p>The scatter plot of goals versus total attempts visually illustrates
the relationship between the number of shots a player takes and the
goals they score. From the plot, it is evident that there is a positive
correlation between total attempts and goals scored. This suggests that
players who attempt more shots tend to score more goals, highlighting
the importance of offensive opportunities in game performance.</p>
<h3 id="correlation-matrix-analysis">Correlation Matrix Analysis:</h3>
<p>The correlation matrix provides a comprehensive overview of the
relationships between various player statistics. Key insights
include:</p>
<ul>
<li>A strong positive correlation between minutes played and various
performance metrics such as goals, assists, and total attempts,
indicating that players who spend more time on the field generally have
higher contributions in these areas.</li>
<li>A notable positive correlation between pass accuracy and pass
completions suggests efficient passing contributes significantly to game
control and offensive setups.</li>
<li>Defensive actions such as tackles and balls recovered are moderately
correlated with fouls committed, suggesting that more aggressive or
active defenders are likely to commit more fouls.</li>
</ul>
<p>These findings can guide more focused training strategies and player
evaluations, particularly by emphasizing the importance of shot
opportunities and efficient passing in enhancing player and team
performance.</p>
</div>
<div class="cell code" data-execution_count="750">
<div class="sourceCode" id="cb20"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># scatter plot of goals vs total attempts</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(x<span class="op">=</span><span class="st">&#39;total_attempts&#39;</span>, y<span class="op">=</span><span class="st">&#39;goals&#39;</span>, data<span class="op">=</span>master_df)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Goals vs. Total Attempts&#39;</span>)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Total Attempts&#39;</span>)</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Goals&#39;</span>)</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a><span class="co"># exclude non-numeric columns before calculating correlation</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>numeric_columns <span class="op">=</span> master_df.select_dtypes(include<span class="op">=</span>[np.number])  </span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>correlation_matrix <span class="op">=</span> numeric_columns.corr()  </span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a><span class="co"># plotting the correlation matrix</span></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">20</span>, <span class="dv">18</span>))</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>sns.heatmap(correlation_matrix, annot<span class="op">=</span><span class="va">True</span>, cmap<span class="op">=</span><span class="st">&#39;coolwarm&#39;</span>, fmt<span class="op">=</span><span class="st">&quot;.2f&quot;</span>)</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Correlation Matrix of Player Stats&#39;</span>)</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_ea965f5ca11141b9b8f78c89238b0122/eb7248dd0b327f871ac0688b560616e4dee08ea5.png" /></p>
</div>
<div class="output display_data">
<p><img
src="vertopal_ea965f5ca11141b9b8f78c89238b0122/a8e140d21eb6bb960dc9774df52b6fd1bc2497c0.png" /></p>
</div>
</div>
<section id="position-specific-goal-analysis" class="cell markdown">
<h3>Position-Specific Goal Analysis:</h3>
<p>The bar chart titled "Average Goals by Position" provides a clear
visual representation of how different player positions contribute to
scoring within a team. Here’s a breakdown of the insights from this
chart:</p>
<ul>
<li><strong>Forwards</strong> tend to score the highest number of goals
on average, which is expected as they are primarily responsible for
finishing offensive plays.</li>
<li><strong>Midfielders</strong> also contribute significantly to the
team's goal tally, reflecting their role in both creating and finishing
scoring opportunities.</li>
<li><strong>Defenders</strong> and <strong>Goalkeepers</strong> have
much lower goal averages, which aligns with their primary defensive
responsibilities rather than scoring.</li>
</ul>
<p>These statistics highlight the distinct roles within a team and
underscore the importance of strategic positioning and role clarity in
maximizing each player’s contributions to the team’s success. This
analysis can help coaches and team managers better understand player
effectiveness in various positions and adjust their game strategies and
training programs accordingly.</p>
</section>
<div class="cell code" data-execution_count="751">
<div class="sourceCode" id="cb21"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># average goals by position</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>sns.barplot(x<span class="op">=</span><span class="st">&#39;position&#39;</span>, y<span class="op">=</span><span class="st">&#39;goals&#39;</span>, data<span class="op">=</span>master_df, estimator<span class="op">=</span>np.mean)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Average Goals by Position&#39;</span>)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Position&#39;</span>)</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Average Goals&#39;</span>)</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_ea965f5ca11141b9b8f78c89238b0122/76dd896bef0e57744b155549e8b780d2fd25f028.png" /></p>
</div>
</div>
<section id="analysis-of-goal-types" class="cell markdown">
<h3>Analysis of Goal Types:</h3>
<p>The bar chart titled "Distribution of Goal Types" visually
categorizes the goals scored into different types, offering insights
into the predominant scoring techniques utilized by players. Here's a
breakdown of what this chart illustrates:</p>
<ul>
<li><strong>Right Foot Goals</strong>: The most common type of goal,
highlighting that many players prefer using their dominant foot.</li>
<li><strong>Left Foot Goals</strong>: Slightly less common than right
foot goals, indicating a preference but also showcasing the
ambidexterity in play.</li>
<li><strong>Headers</strong>: Represent a significant portion but are
less frequent than foot goals. This type could indicate the
effectiveness of aerial ability in the league.</li>
<li><strong>Others</strong>: This category might include backheels,
chest, and perhaps even accidental goals, which occur the least
frequently.</li>
</ul>
<p>This analysis helps in understanding the scoring dynamics and can aid
coaches in focusing training on improving specific types of goal-scoring
abilities based on the team's current stats. It also helps in scouting
by identifying players with exceptional skills in less common goal types
that might offer a tactical advantage.</p>
</section>
<div class="cell code" data-execution_count="752">
<div class="sourceCode" id="cb22"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="co"># create a DataFrame for goal types</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>goal_types <span class="op">=</span> master_df[[<span class="st">&#39;left_foot&#39;</span>, <span class="st">&#39;right_foot&#39;</span>, <span class="st">&#39;headers&#39;</span>, <span class="st">&#39;others&#39;</span>]]</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>goal_types_sum <span class="op">=</span> goal_types.<span class="bu">sum</span>().reset_index()</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>goal_types_sum.columns <span class="op">=</span> [<span class="st">&#39;Goal Type&#39;</span>, <span class="st">&#39;Count&#39;</span>]</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a><span class="co"># bar plot for goal types</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>sns.barplot(x<span class="op">=</span><span class="st">&#39;Goal Type&#39;</span>, y<span class="op">=</span><span class="st">&#39;Count&#39;</span>, data<span class="op">=</span>goal_types_sum)</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Distribution of Goal Types&#39;</span>)</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Number of Goals&#39;</span>)</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Type of Goal&#39;</span>)</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_ea965f5ca11141b9b8f78c89238b0122/001522357f12997198cc0c699101a358c0992197.png" /></p>
</div>
</div>
<section id="analysis-of-goals-by-location" class="cell markdown">
<h3>Analysis of Goals by Location:</h3>
<p>The bar chart titled "Goals Scored Inside vs. Outside the Area"
provides a visual representation of where goals are predominantly scored
during matches. Here are the key takeaways:</p>
<ul>
<li><strong>Inside the Area</strong>: Significantly more goals are
scored from within the penalty area, which underscores the importance of
close-range finishing skills and the strategic focus on creating scoring
opportunities close to the goal.</li>
<li><strong>Outside the Area</strong>: A smaller number of goals come
from outside the penalty area, highlighting these events as less
frequent but potentially spectacular moments in a game.</li>
</ul>
<p>This analysis helps to emphasize the tactical aspects of football
where positioning and precision in the final third are crucial for
scoring. Coaches might use this data to reinforce strategies that
exploit the penalty area more effectively, while also encouraging
practices that could improve long-range shooting capabilities for
situations that demand it. This insight is also beneficial for
goalkeepers and defenders as it highlights the need to tighten defense
inside the box and prepare for long-range shots.</p>
</section>
<div class="cell code" data-execution_count="753">
<div class="sourceCode" id="cb23"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create a DataFrame for goal locations</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>goal_locations <span class="op">=</span> master_df[[<span class="st">&#39;inside_area&#39;</span>, <span class="st">&#39;outside_areas&#39;</span>]]</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>goal_locations_sum <span class="op">=</span> goal_locations.<span class="bu">sum</span>().reset_index()</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>goal_locations_sum.columns <span class="op">=</span> [<span class="st">&#39;Location&#39;</span>, <span class="st">&#39;Count&#39;</span>]</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="co"># barplot for goal locations</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>sns.barplot(x<span class="op">=</span><span class="st">&#39;Location&#39;</span>, y<span class="op">=</span><span class="st">&#39;Count&#39;</span>, data<span class="op">=</span>goal_locations_sum)</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Goals Scored Inside vs. Outside the Area&#39;</span>)</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Number of Goals&#39;</span>)</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Goal Location&#39;</span>)</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_ea965f5ca11141b9b8f78c89238b0122/c661f9bbb17cb6bc941789ef3347c7c2774d26e1.png" /></p>
</div>
</div>
<section id="analysis-of-penalty-goals" class="cell markdown">
<h3>Analysis of Penalty Goals:</h3>
<p>The histogram titled "Distribution of Penalty Goals" visualizes the
frequency of goals scored from penalties. Here are the key insights:</p>
<ul>
<li><strong>High Frequency of Zero</strong>: A significant majority of
players have not scored from penalties, indicating that penalty
opportunities are either rare or concentrated among a few players.</li>
<li><strong>Decreasing Frequency for Higher Counts</strong>: There are
very few instances of players scoring multiple penalty goals, which
reflects the special circumstances under which penalties are awarded and
the specific role of designated penalty takers within teams.</li>
</ul>
<p>This analysis underscores the importance of having skilled and
reliable penalty takers on a team. It also highlights the strategic
value of penalties in tight matches, where converting a single penalty
can be decisive. Coaches and analysts might use this data to assess the
effectiveness of their penalty takers and possibly scout for players who
excel in these situations. This distribution also suggests a focus on
training for penalty situations both for shooters and goalkeepers.</p>
</section>
<div class="cell code" data-execution_count="754">
<div class="sourceCode" id="cb24"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># histogram for penalties</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>sns.histplot(master_df[<span class="st">&#39;penalties&#39;</span>], color<span class="op">=</span><span class="st">&#39;red&#39;</span>, kde<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Distribution of Penalty Goals&#39;</span>)</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Penalty Goals&#39;</span>)</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Frequency&#39;</span>)</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a><span class="co"># summarize penalties</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>total_penalties <span class="op">=</span> master_df[<span class="st">&#39;penalties&#39;</span>].<span class="bu">sum</span>()</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Total penalty goals scored: </span><span class="sc">{</span>total_penalties<span class="sc">}</span><span class="ss">&quot;</span>)</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_ea965f5ca11141b9b8f78c89238b0122/b41ff3ba394020833b36b5fc54fa17a90552e5b0.png" /></p>
</div>
<div class="output stream stdout">
<pre><code>Total penalty goals scored: 36.0
</code></pre>
</div>
</div>
<div class="cell markdown">
<ol>
<li><strong>Fouls Committed vs. Fouls Suffered by Club</strong>:
<ul>
<li>The scatter plot demonstrates the relationship between fouls
committed and fouls suffered for various clubs.</li>
<li>This visualization helps identify clubs that are more aggressive or
more frequently targeted within the league, as indicated by the
distribution of points. Clubs with a higher number of fouls committed or
suffered might be engaged in more physical play styles.</li>
<li>It also allows for a comparative analysis between the defensive
tactics and aggressiveness of different teams, potentially impacting
their disciplinary records.</li>
</ul></li>
<li><strong>Distribution of Red and Yellow Cards</strong>:
<ul>
<li>The histogram provides a clear view of the distribution of red and
yellow cards across the league.</li>
<li>The frequency of yellow cards is significantly higher than red
cards, suggesting that while aggressive play may be common, it rarely
escalates to the level warranting a red card.</li>
<li>This plot can be used to understand the discipline level across the
league, identifying teams or players that might pose disciplinary risks
or are particularly disciplined in their play style.</li>
</ul></li>
</ol>
</div>
<div class="cell code" data-execution_count="755">
<div class="sourceCode" id="cb26"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="co"># fouls committed vs. fouls suffered</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(data<span class="op">=</span>master_df, x<span class="op">=</span><span class="st">&#39;fouls_committed&#39;</span>, y<span class="op">=</span><span class="st">&#39;fouls_suffered&#39;</span>, hue<span class="op">=</span><span class="st">&#39;club&#39;</span>)</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Fouls Committed vs. Fouls Suffered by Club&#39;</span>)</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Fouls Committed&#39;</span>)</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Fouls Suffered&#39;</span>)</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a><span class="co"># frequency of red and yellow cards</span></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">7</span>))</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>sns.histplot(data<span class="op">=</span>master_df, x<span class="op">=</span><span class="st">&#39;red&#39;</span>, bins<span class="op">=</span><span class="dv">30</span>, color<span class="op">=</span><span class="st">&#39;red&#39;</span>, label<span class="op">=</span><span class="st">&#39;Red Cards&#39;</span>, kde<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>sns.histplot(data<span class="op">=</span>master_df, x<span class="op">=</span><span class="st">&#39;yellow&#39;</span>, bins<span class="op">=</span><span class="dv">30</span>, color<span class="op">=</span><span class="st">&#39;yellow&#39;</span>, label<span class="op">=</span><span class="st">&#39;Yellow Cards&#39;</span>, kde<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Distribution of Red and Yellow Cards&#39;</span>)</span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Number of Cards&#39;</span>)</span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Frequency&#39;</span>)</span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_ea965f5ca11141b9b8f78c89238b0122/6092d91abdf198847f9e97aa4b91b4e2e62bd0a8.png" /></p>
</div>
<div class="output display_data">
<p><img
src="vertopal_ea965f5ca11141b9b8f78c89238b0122/6f430100456383bb7031b1595c84c51b856660cc.png" /></p>
</div>
</div>
<div class="cell markdown">
<h3 id="impact-of-playing-time-on-goals-scored">Impact of Playing Time
on Goals Scored</h3>
<p>The scatter plot above displays the relationship between the total
minutes played by players and the number of goals they scored during the
season. It highlights a trend where players with more playing time tend
to score more goals, suggesting that increased field presence may
correlate with higher scoring opportunities. This is particularly
evident for a few players who have played over 800 minutes and scored
upwards of 6 goals, indicating key players who significantly contribute
to their team's offensive capabilities.</p>
<h3 id="minutes-played-vs-distance-covered">Minutes Played vs Distance
Covered</h3>
<p>This scatter plot illustrates the relationship between the total
minutes players have been on the field and the distance they have
covered. The graph shows a strong positive correlation between these two
metrics, indicating that as players spend more time on the pitch, their
total distance covered also increases. This relationship is linear for
the majority of players, highlighting consistent physical performance
across different playtimes. The data may be useful for conditioning
coaches and managers to assess player stamina and in-game activity
levels.</p>
</div>
<div class="cell code" data-execution_count="756">
<div class="sourceCode" id="cb27"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="co"># convert columns to float</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>master_df[<span class="st">&#39;minutes_played&#39;</span>] <span class="op">=</span> pd.to_numeric(master_df[<span class="st">&#39;minutes_played&#39;</span>], errors<span class="op">=</span><span class="st">&#39;coerce&#39;</span>)</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>master_df[<span class="st">&#39;distance_covered&#39;</span>] <span class="op">=</span> pd.to_numeric(master_df[<span class="st">&#39;distance_covered&#39;</span>], errors<span class="op">=</span><span class="st">&#39;coerce&#39;</span>)</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="co"># scatter plot of minutes played vs goals scored</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(x<span class="op">=</span><span class="st">&#39;minutes_played&#39;</span>, y<span class="op">=</span><span class="st">&#39;goals&#39;</span>, data<span class="op">=</span>master_df, color<span class="op">=</span><span class="st">&#39;blue&#39;</span>)</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Impact of Playing Time on Goals Scored&#39;</span>)</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Minutes Played&#39;</span>)</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Goals Scored&#39;</span>)</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a><span class="co"># minutes played vs distance covered</span></span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(x<span class="op">=</span><span class="st">&#39;minutes_played&#39;</span>, y<span class="op">=</span><span class="st">&#39;distance_covered&#39;</span>, data<span class="op">=</span>master_df, color<span class="op">=</span><span class="st">&#39;green&#39;</span>)</span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Minutes Played vs Distance Covered&#39;</span>)</span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Minutes Played&#39;</span>)</span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Distance Covered (km)&#39;</span>)</span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_ea965f5ca11141b9b8f78c89238b0122/1de17a0e26f5b72714b171cb5350551d742a835a.png" /></p>
</div>
<div class="output display_data">
<p><img
src="vertopal_ea965f5ca11141b9b8f78c89238b0122/f89127d29dcb9892b642c66ca0237da19cbfcb8d.png" /></p>
</div>
</div>
<div class="cell markdown">
<h3 id="average-assists-by-position">Average Assists by Position</h3>
<p>This bar chart visualizes the average number of assists made by
players across different positions. We observe that forwards and
midfielders contribute significantly to creating goal opportunities, as
indicated by their higher average assists. This suggests that these
positions are crucial in offensive play, with midfielders slightly
outperforming forwards in assisting capabilities. Defenders and
goalkeepers show much lower averages, which aligns with their primary
defensive responsibilities.</p>
<h3 id="fouls-committed-by-position">Fouls Committed by Position</h3>
<p>The violin plot illustrates the distribution of fouls committed by
players according to their positions. It highlights that forwards and
midfielders tend to commit more fouls compared to defenders and
goalkeepers. The wider distributions for forwards and midfielders
indicate a variation in play style, with some players engaging more
aggressively than others. The plot shows that midfielders, while
involved in creating plays, also partake actively in defensive actions,
sometimes leading to fouls. In contrast, the narrow distribution for
goalkeepers confirms fewer instances of fouls, which is expected given
their limited interaction with outfield players.</p>
</div>
<div class="cell code" data-execution_count="757">
<div class="sourceCode" id="cb28"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="co"># bar plot of average assists by position</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>sns.barplot(x<span class="op">=</span><span class="st">&#39;position&#39;</span>, y<span class="op">=</span><span class="st">&#39;assists&#39;</span>, data<span class="op">=</span>master_df, estimator<span class="op">=</span>np.mean)</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Average Assists by Position&#39;</span>)</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Position&#39;</span>)</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Average Assists&#39;</span>)</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a><span class="co"># distribution of fouls committed by position</span></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>sns.violinplot(x<span class="op">=</span><span class="st">&#39;position&#39;</span>, y<span class="op">=</span><span class="st">&#39;fouls_committed&#39;</span>, data<span class="op">=</span>master_df)</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Fouls Committed by Position&#39;</span>)</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Position&#39;</span>)</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Fouls Committed&#39;</span>)</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_ea965f5ca11141b9b8f78c89238b0122/92be04d85abaeb862fedf54e50d680dba5bc194e.png" /></p>
</div>
<div class="output display_data">
<p><img
src="vertopal_ea965f5ca11141b9b8f78c89238b0122/624a9a776f4cd08468e08b091ae03aaeca1ef7f5.png" /></p>
</div>
</div>
<section id="goal-scoring-efficiency-analysis" class="cell markdown">
<h3>Goal Scoring Efficiency Analysis</h3>
<p>This section evaluates player goal efficiency, which is defined as
the ratio of goals scored to total attempts on goal. Goal efficiency is
a crucial metric that helps in understanding a player's effectiveness in
converting scoring opportunities into goals.</p>
<p><strong>Adjustments and Corrections:</strong> Before diving into the
analysis, it was necessary to address inconsistencies in the dataset.
Several players were showing goals scored without any recorded attempts,
which is not feasible in practical scenarios. These entries were
identified and excluded from the efficiency calculation to maintain data
integrity and relevance.</p>
<p><strong>Analysis:</strong> After cleaning the dataset, the efficiency
of goal scorers was calculated by dividing the number of goals by the
total attempts. This metric gives us a percentage that represents how
often a player scores when they attempt to. Players with higher
efficiency are those who need fewer attempts to score, indicating higher
precision or better opportunity utilization.</p>
<p><strong>Results:</strong> The results will showcase the top 10
players who are most efficient in front of goal, emphasizing those who
maximize their scoring opportunities effectively. This analysis not only
highlights the sharpshooters but also aids in tactical planning where
efficiency can be prioritized over volume in certain strategic
setups.</p>
<p>This approach ensures that the analysis remains focused on realistic
and actionable insights, aligning with broader performance evaluation
strategies in sports analytics.</p>
</section>
<div class="cell code" data-execution_count="758">
<div class="sourceCode" id="cb29"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># exclude entries where total_attempts are zero</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>filtered_df <span class="op">=</span> master_df[master_df[<span class="st">&#39;total_attempts&#39;</span>] <span class="op">&gt;</span> <span class="dv">0</span>].copy()</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate goal scoring efficiency</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>filtered_df[<span class="st">&#39;goal_efficiency&#39;</span>] <span class="op">=</span> filtered_df[<span class="st">&#39;goals&#39;</span>] <span class="op">/</span> filtered_df[<span class="st">&#39;total_attempts&#39;</span>]</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="co"># display top 10 efficient goal scorers</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>top_scorers <span class="op">=</span> filtered_df.sort_values(by<span class="op">=</span><span class="st">&#39;goal_efficiency&#39;</span>, ascending<span class="op">=</span><span class="va">False</span>).head(<span class="dv">10</span>)</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(top_scorers[[<span class="st">&#39;player_name&#39;</span>, <span class="st">&#39;club&#39;</span>, <span class="st">&#39;position&#39;</span>, <span class="st">&#39;goals&#39;</span>, <span class="st">&#39;total_attempts&#39;</span>, <span class="st">&#39;goal_efficiency&#39;</span>]])</span></code></pre></div>
<div class="output stream stdout">
<pre><code>        player_name         club    position  goals  total_attempts  \
354      Kulusevski     Juventus  Midfielder    1.0             1.0   
462         Montero     Beşiktaş    Defender    1.0             1.0   
333        Klaassen         Ajax  Midfielder    1.0             1.0   
332       Kjærgaard     Salzburg  Midfielder    1.0             1.0   
20      Alex Telles  Man. United    Defender    1.0             1.0   
560     Rafael Leão        Milan     Forward    1.0             1.0   
451  Messias Junior        Milan     Forward    1.0             1.0   
465          Morato      Benfica    Defender    1.0             1.0   
118       Chukwueze   Villarreal  Midfielder    2.0             3.0   
253       Greenwood  Man. United     Forward    1.0             2.0   

     goal_efficiency  
354         1.000000  
462         1.000000  
333         1.000000  
332         1.000000  
20          1.000000  
560         1.000000  
451         1.000000  
465         1.000000  
118         0.666667  
253         0.500000  
</code></pre>
</div>
</div>
<div class="cell markdown">
<p><strong>Defensive Metrics Per Match Analysis</strong></p>
<p>To better understand the defensive contributions of players across
different matches, I calculated two key metrics: 'tackles per match' and
'balls recovered per match'. These metrics provide insights into the
defensive activity and effectiveness of players, particularly defenders
and midfielders who play pivotal roles in disrupting the opposition's
attacks.</p>
<p>In the analysis, the <code>tackles_per_match</code> metric is
computed by dividing the total number of tackles made by a player by the
number of matches they played. Similarly,
<code>balls_recovered_per_match</code> measures how many times a player
successfully regained possession by recovering loose balls, normalized
over the matches played.</p>
<p>Upon reviewing the top performers based on 'balls recovered per
match', it becomes evident that certain defenders and midfielders stand
out due to their consistent defensive efforts. For example, Koundé from
Sevilla leads with an impressive average of 9.60 balls recovered per
match, highlighting his keen positional sense and ability to read the
game. This metric, coupled with tackles per match, helps identify
players who are integral to their teams' defensive solidity.</p>
</div>
<div class="cell code" data-execution_count="759">
<div class="sourceCode" id="cb31"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate per match defensive metrics</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>master_df[<span class="st">&#39;tackles_per_match&#39;</span>] <span class="op">=</span> master_df[<span class="st">&#39;tackles&#39;</span>] <span class="op">/</span> master_df[<span class="st">&#39;match_played&#39;</span>]</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>master_df[<span class="st">&#39;balls_recovered_per_match&#39;</span>] <span class="op">=</span> master_df[<span class="st">&#39;balls_recoverd&#39;</span>] <span class="op">/</span> master_df[<span class="st">&#39;match_played&#39;</span>]</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="co"># display top defenders</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>top_defenders <span class="op">=</span> master_df.sort_values(by<span class="op">=</span><span class="st">&#39;balls_recovered_per_match&#39;</span>, ascending<span class="op">=</span><span class="va">False</span>).head(<span class="dv">10</span>)</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(top_defenders[[<span class="st">&#39;player_name&#39;</span>, <span class="st">&#39;club&#39;</span>, <span class="st">&#39;position&#39;</span>, <span class="st">&#39;tackles_per_match&#39;</span>, <span class="st">&#39;balls_recovered_per_match&#39;</span>]])</span></code></pre></div>
<div class="output stream stdout">
<pre><code>    player_name              club    position  tackles_per_match  \
344      Koundé           Sevilla    Defender               0.00   
67       Bondar  Shakhtar Donetsk    Defender               0.00   
214    Fernando           Sevilla  Midfielder               0.50   
673       Tolói          Atalanta    Defender               1.50   
517    Palomino          Atalanta    Defender               1.20   
635       Souza          Beşiktaş  Midfielder               4.00   
703        Vida          Beşiktaş    Defender               0.50   
260  Guilavogui         Wolfsburg  Midfielder               1.20   
11       Akanji          Dortmund    Defender               1.00   
721    Welinton          Beşiktaş    Defender               3.25   

     balls_recovered_per_match  
344                       9.60  
67                        9.00  
214                       8.50  
673                       8.50  
517                       8.20  
635                       8.00  
703                       8.00  
260                       7.80  
11                        7.80  
721                       7.75  
</code></pre>
</div>
</div>
<div class="cell markdown">
<p>In examining the contributions of players who lead in assists, it's
insightful to consider not only the number of assists but also their
pass efficiency. This metric highlights players who not only create
scoring opportunities but also excel in their overall passing game,
ensuring effective ball distribution and maintaining possession under
pressure. For instance, Bruno Fernandes from Manchester United not only
tops the assist chart with 7 assists but also shows a commendable pass
efficiency of approximately 77%. Similarly, Luka Modrić from Real
Madrid, while matching others with four assists, distinguishes himself
with an impressive pass efficiency rate of over 90%, underscoring his
pivotal role in midfield dynamics.</p>
</div>
<div class="cell code" data-execution_count="760">
<div class="sourceCode" id="cb33"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate pass efficiency</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>master_df[<span class="st">&#39;pass_efficiency&#39;</span>] <span class="op">=</span> master_df[<span class="st">&#39;pass_completed&#39;</span>] <span class="op">/</span> master_df[<span class="st">&#39;pass_attempted&#39;</span>]</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="co"># identify top players by assists and include pass efficiency</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>top_assist_providers <span class="op">=</span> master_df.sort_values(by<span class="op">=</span><span class="st">&#39;assists&#39;</span>, ascending<span class="op">=</span><span class="va">False</span>).head(<span class="dv">10</span>)</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(top_assist_providers[[<span class="st">&#39;player_name&#39;</span>, <span class="st">&#39;club&#39;</span>, <span class="st">&#39;position&#39;</span>, <span class="st">&#39;assists&#39;</span>, <span class="st">&#39;pass_efficiency&#39;</span>]])</span></code></pre></div>
<div class="output stream stdout">
<pre><code>          player_name         club    position  assists  pass_efficiency
87    Bruno Fernandes  Man. United  Midfielder      7.0         0.771605
606              Sané       Bayern  Midfielder      6.0         0.869347
705   Vinícius Júnior  Real Madrid     Forward      6.0         0.835920
30             Antony         Ajax     Forward      5.0         0.813665
311        João Mário      Benfica  Midfielder      4.0         0.902985
146         De Bruyne    Man. City  Midfielder      4.0         0.841310
100            Capoue   Villarreal  Midfielder      4.0         0.892057
437            Mbappé        Paris     Forward      4.0         0.856031
21   Alexander-Arnold    Liverpool    Defender      4.0         0.811679
459            Modrić  Real Madrid  Midfielder      4.0         0.904881
</code></pre>
</div>
</div>
<div class="cell markdown">
<p>In this section, we explore the total offensive contributions of
players in terms of goals and assists combined. By aggregating these two
metrics, we identify the players who have had the most significant
impact on their team's offensive performance during the season.</p>
<p>Robert Lewandowski and Karim Benzema stand out with the highest total
contributions, each influencing 16 scoring plays for their teams.
Lewandowski's 13 goals and 3 assists and Benzema's 15 goals and 1 assist
underscore their pivotal roles as lead strikers, where not only do they
finish opportunities, but they also create them.</p>
<p>The data also reveals the versatility of players like Leroy Sané and
Vinícius Júnior, who equally balance their contributions between goals
and assists, highlighting their dual-threat capabilities on the field.
This analysis underscores the importance of multifaceted players who can
adapt to various game situations, enhancing their team’s offensive
dynamics.</p>
<p>Overall, this evaluation of total contributions is instrumental in
assessing the direct impact players have on the game outcomes, serving
as a key metric for both team strategy and player valuation.</p>
</div>
<div class="cell code" data-execution_count="761">
<div class="sourceCode" id="cb35"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create a new column &#39;total_contributions&#39; that sums goals and assists</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>master_df[<span class="st">&#39;total_contributions&#39;</span>] <span class="op">=</span> master_df[<span class="st">&#39;goals&#39;</span>] <span class="op">+</span> master_df[<span class="st">&#39;assists&#39;</span>]</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="co"># sort the DataFrame </span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>top_forward_contributors <span class="op">=</span> master_df.sort_values(by<span class="op">=</span><span class="st">&#39;total_contributions&#39;</span>, ascending<span class="op">=</span><span class="va">False</span>).head(<span class="dv">10</span>)</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(top_forward_contributors[[<span class="st">&#39;player_name&#39;</span>, <span class="st">&#39;club&#39;</span>, <span class="st">&#39;position&#39;</span>, <span class="st">&#39;goals&#39;</span>, <span class="st">&#39;assists&#39;</span>, <span class="st">&#39;total_contributions&#39;</span>]])</span></code></pre></div>
<div class="output stream stdout">
<pre><code>         player_name         club    position  goals  assists  \
376      Lewandowski       Bayern     Forward   13.0      3.0   
57           Benzema  Real Madrid     Forward   15.0      1.0   
606             Sané       Bayern  Midfielder    6.0      6.0   
272           Haller         Ajax     Forward   11.0      1.0   
602            Salah    Liverpool     Forward    8.0      2.0   
437           Mbappé        Paris     Forward    6.0      4.0   
705  Vinícius Júnior  Real Madrid     Forward    4.0      6.0   
401           Mahrez    Man. City  Midfielder    7.0      2.0   
141          Danjuma   Villarreal  Midfielder    6.0      2.0   
481           Müller       Bayern     Forward    4.0      3.0   

     total_contributions  
376                 16.0  
57                  16.0  
606                 12.0  
272                 12.0  
602                 10.0  
437                 10.0  
705                 10.0  
401                  9.0  
141                  8.0  
481                  7.0  
</code></pre>
</div>
</div>
<div class="cell markdown">
<p>This visualization examines the relationship between playing time and
players' offensive contributions, specifically their goals scored and
assists provided, across different positions. Each point represents a
player, with their position indicated by color and symbol, and the size
of the point proportional to the number of assists.</p>
<p>The analysis clearly shows that forwards and midfielders generally
contribute more goals, especially as their minutes played increase. It's
also apparent that players with significant assists tend to have
substantial playing time, reinforcing the notion that more time on the
field often translates into more opportunities to impact the game.</p>
<p>Key outliers, such as forwards with exceptionally high goals with
relatively lower playing time, could be indicative of highly efficient
goal scorers. Conversely, players with substantial minutes but fewer
goals or assists might be in roles that contribute in other ways not
captured solely by these metrics.</p>
</div>
<div class="cell code" data-execution_count="762">
<div class="sourceCode" id="cb37"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># analyze the impact of minutes played on goals and assists by position</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">8</span>))</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(x<span class="op">=</span><span class="st">&#39;minutes_played&#39;</span>, y<span class="op">=</span><span class="st">&#39;goals&#39;</span>, hue<span class="op">=</span><span class="st">&#39;position&#39;</span>, style<span class="op">=</span><span class="st">&#39;position&#39;</span>, size<span class="op">=</span><span class="st">&#39;assists&#39;</span>, data<span class="op">=</span>master_df)</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Impact of Playing Time on Goals and Assists by Position&#39;</span>)</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Minutes Played&#39;</span>)</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Goals&#39;</span>)</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>plt.legend(loc<span class="op">=</span><span class="st">&#39;upper left&#39;</span>)</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_ea965f5ca11141b9b8f78c89238b0122/9c3238473258cb748c919c802ea386285cca643a.png" /></p>
</div>
</div>
<section id="forward-position-predictive-modeling"
class="cell markdown">
<h3>Forward Position Predictive Modeling</h3>
<p>In this section, we develop a predictive model to forecast the total
contributions (goals plus assists) of forwards based on their playing
statistics. The model aims to identify how well we can predict a
forward's impact on the game using their performance metrics.</p>
<h4 id="model-development">Model Development:</h4>
<ol>
<li><strong>Feature Selection</strong>: We chose the features
<code>total_attempts</code>, <code>on_target</code>,
<code>minutes_played</code>, and <code>pass_completed</code>. These
features are selected based on the assumption that they directly
influence a forward's ability to score or assist.</li>
<li><strong>Data Preparation</strong>: We split our data into training
and testing sets with an 80/20 ratio, ensuring that our model can be
validated against unseen data.</li>
<li><strong>Model Building</strong>: We employed a Linear Regression
model due to its simplicity and interpretability, which is ideal for
demonstration purposes in this tutorial.</li>
<li><strong>Model Fitting</strong>: The model is trained on the training
dataset, which involves finding the best coefficients for our features
that minimize errors in predicting the target variable.</li>
</ol>
<h4 id="results">Results:</h4>
<ul>
<li>The Mean Squared Error (MSE) of the model on the test set is
approximately 2.694. This metric tells us how close the predicted values
are to the actual values, with a lower score indicating better
performance. Here, the MSE suggests that our model, while simplistic,
captures a reasonable amount of variance in forward contributions but
also highlights the potential for improvement.</li>
</ul>
<h4 id="interpretation">Interpretation:</h4>
<ul>
<li>The MSE value provides an indication of the average squared
difference between the predicted and actual contributions. Given the
context of football data, an MSE of around 2.694 might be acceptable for
preliminary models but requires further refinement for professional
analytical use.</li>
<li>The use of features like <code>minutes_played</code> and
<code>total_attempts</code> suggests that as forwards participate more
in the game and take more shots, their likelihood of contributing
through goals or assists increases.</li>
</ul>
<h4 id="next-steps">Next Steps:</h4>
<ul>
<li><strong>Model Enhancement</strong>: We can improve the model's
performance by incorporating more complex features or using more
sophisticated modeling techniques like ensemble methods or neural
networks.</li>
<li><strong>Feature Engineering</strong>: Consider deriving new features
that capture more nuances, such as shot accuracy percentage or
involvement in key plays, to see if they provide additional predictive
power.</li>
<li><strong>Cross-Validation</strong>: Implement k-fold cross-validation
to ensure that our model's performance is robust and not dependent on
the particular split of the data used.</li>
</ul>
</section>
<div class="cell code" data-execution_count="763">
<div class="sourceCode" id="cb38"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LinearRegression</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> mean_squared_error</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="co"># create a new target column &#39;total_contributions&#39; for forwards</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>master_df.loc[master_df[<span class="st">&#39;position&#39;</span>] <span class="op">==</span> <span class="st">&#39;Forward&#39;</span>, <span class="st">&#39;total_contributions&#39;</span>] <span class="op">=</span> master_df[<span class="st">&#39;goals&#39;</span>] <span class="op">+</span> master_df[<span class="st">&#39;assists&#39;</span>]</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a><span class="co"># selecting features and the target</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>forward_features <span class="op">=</span> master_df[master_df[<span class="st">&#39;position&#39;</span>] <span class="op">==</span> <span class="st">&#39;Forward&#39;</span>][[<span class="st">&#39;total_attempts&#39;</span>, <span class="st">&#39;on_target&#39;</span>, <span class="st">&#39;minutes_played&#39;</span>, <span class="st">&#39;pass_completed&#39;</span>]]</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>forward_contributions <span class="op">=</span> master_df[master_df[<span class="st">&#39;position&#39;</span>] <span class="op">==</span> <span class="st">&#39;Forward&#39;</span>][<span class="st">&#39;total_contributions&#39;</span>]</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a><span class="co"># splitting the dataset</span></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(forward_features, forward_contributions, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a><span class="co"># building the model for forwards</span></span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>model_forward <span class="op">=</span> LinearRegression()</span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>model_forward.fit(X_train, y_train)</span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a>y_pred <span class="op">=</span> model_forward.predict(X_test)</span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a><span class="co"># evaluate the model</span></span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a>mse <span class="op">=</span> mean_squared_error(y_test, y_pred)</span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Forward Position - Mean Squared Error:&quot;</span>, mse)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Forward Position - Mean Squared Error: 2.693939946343747
</code></pre>
</div>
</div>
<section id="midfielder-position-predictive-modeling"
class="cell markdown">
<h3>Midfielder Position Predictive Modeling</h3>
<p>In this part of the tutorial, we focus on building a predictive model
for midfielders to estimate their total contributions (goals plus
assists) based on selected performance metrics. This model seeks to
quantify the impact midfielders have on matches through their offensive
contributions.</p>
<h4 id="model-development">Model Development:</h4>
<ol>
<li><strong>Feature Selection</strong>: We chose
<code>minutes_played</code>, <code>total_attempts</code>, and
<code>pass_completed</code> as features. These were selected because
they represent significant aspects of a midfielder's game that could
influence their scoring and assisting abilities.</li>
<li><strong>Data Preparation</strong>: The dataset was divided into
training (70%) and testing (30%) sets. This split helps in validating
the model's effectiveness on unseen data.</li>
<li><strong>Model Building</strong>: A Linear Regression model was
utilized for its simplicity and for educational purposes within this
tutorial. Linear Regression provides a good starting point for
regression problems.</li>
<li><strong>Model Fitting</strong>: The model was trained using the
training set, aiming to find the best linear relationship between the
selected features and the midfielder's total contributions.</li>
</ol>
<h4 id="results">Results:</h4>
<ul>
<li>The Mean Squared Error (MSE) for the model is approximately 1.206.
This metric measures the average of the squares of the errors,
indicating the difference between the observed and predicted values. A
lower MSE is better, as it indicates that the model can predict more
accurately.</li>
</ul>
<h4 id="interpretation">Interpretation:</h4>
<ul>
<li>The MSE of 1.206 suggests that the model can reasonably predict the
total contributions of midfielders from their gameplay statistics,
though like any model, it could benefit from further refinement.</li>
<li>The features chosen indicate that the more a midfielder is involved
in the game, both in terms of playing time and ball handling (passes and
attempts), the more likely they are to contribute to goals and
assists.</li>
</ul>
<h4 id="next-steps">Next Steps:</h4>
<ul>
<li><strong>Enhancing the Model</strong>: To improve prediction
accuracy, we might consider incorporating more features such as player
fitness levels, match context (home vs. away), or more detailed passing
statistics.</li>
<li><strong>Advanced Techniques</strong>: Exploring other modeling
techniques like Decision Trees, Random Forest, or even neural networks
could yield better predictive performance.</li>
<li><strong>Feature Engineering</strong>: Experimenting with
interactions between features or polynomial features could capture more
complex relationships that affect midfielder performances.</li>
</ul>
</section>
<div class="cell code" data-execution_count="764">
<div class="sourceCode" id="cb40"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LinearRegression</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> mean_squared_error</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a><span class="co"># filter data for midfielders</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>midfielders <span class="op">=</span> master_df[master_df[<span class="st">&#39;position&#39;</span>] <span class="op">==</span> <span class="st">&#39;Midfielder&#39;</span>].copy()</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a><span class="co"># create a new target column </span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>midfielders[<span class="st">&#39;total_contributions&#39;</span>] <span class="op">=</span> midfielders[<span class="st">&#39;goals&#39;</span>] <span class="op">+</span> midfielders[<span class="st">&#39;assists&#39;</span>]</span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a><span class="co"># selecting features and the new target</span></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>features <span class="op">=</span> midfielders[[<span class="st">&#39;minutes_played&#39;</span>, <span class="st">&#39;total_attempts&#39;</span>, <span class="st">&#39;pass_completed&#39;</span>]]</span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>target <span class="op">=</span> midfielders[<span class="st">&#39;total_contributions&#39;</span>]</span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a><span class="co"># split the data</span></span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(features, target, test_size<span class="op">=</span><span class="fl">0.3</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a><span class="co"># initialize and train the model</span></span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> LinearRegression()</span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a>model.fit(X_train, y_train)</span>
<span id="cb40-21"><a href="#cb40-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-22"><a href="#cb40-22" aria-hidden="true" tabindex="-1"></a><span class="co"># predicting the test set results</span></span>
<span id="cb40-23"><a href="#cb40-23" aria-hidden="true" tabindex="-1"></a>predictions <span class="op">=</span> model.predict(X_test)</span>
<span id="cb40-24"><a href="#cb40-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-25"><a href="#cb40-25" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate the MSE</span></span>
<span id="cb40-26"><a href="#cb40-26" aria-hidden="true" tabindex="-1"></a>mse <span class="op">=</span> mean_squared_error(y_test, predictions)</span>
<span id="cb40-27"><a href="#cb40-27" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Midfielder Position - Mean Squared Error:&quot;</span>, mse)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Midfielder Position - Mean Squared Error:</code></pre>
</div>
<div class="output stream stdout">
<pre><code> 1.205830614483718
</code></pre>
</div>
</div>
<section id="defensive-contributions-predictive-modeling"
class="cell markdown">
<h3>Defensive Contributions Predictive Modeling</h3>
<p>In this part of the tutorial, we delve into predictive modeling for
defenders, focusing on their defensive contributions based on various
match-related statistics. The primary goal here is to estimate a
defender's total contributions, defined as the sum of assists, tackles,
and balls recovered.</p>
<h4 id="initial-linear-regression-model">Initial Linear Regression
Model:</h4>
<ul>
<li><strong>Model Development</strong>: We initially applied a Linear
Regression model using features such as <code>minutes_played</code>,
<code>clearance_attempted</code>, <code>pass_completed</code>, and
<code>distance_covered</code>.</li>
<li><strong>Model Performance</strong>: The initial model resulted in a
high Mean Squared Error (MSE) of 63.36, indicating substantial
prediction errors. This suggested that our model might benefit from
refinement either in feature selection or model complexity.</li>
</ul>
</section>
<div class="cell code" data-execution_count="765">
<div class="sourceCode" id="cb43"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LinearRegression</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> mean_squared_error</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a><span class="co"># create a new target &#39;defensive_contributions&#39; for defenders</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>master_df.loc[master_df[<span class="st">&#39;position&#39;</span>] <span class="op">==</span> <span class="st">&#39;Defender&#39;</span>, <span class="st">&#39;defensive_contributions&#39;</span>] <span class="op">=</span> master_df[<span class="st">&#39;assists&#39;</span>] <span class="op">+</span> master_df[<span class="st">&#39;tackles&#39;</span>] <span class="op">+</span> master_df[<span class="st">&#39;balls_recoverd&#39;</span>]</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a><span class="co"># selecting features and the new target</span></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>defender_features <span class="op">=</span> master_df[master_df[<span class="st">&#39;position&#39;</span>] <span class="op">==</span> <span class="st">&#39;Defender&#39;</span>][[<span class="st">&#39;minutes_played&#39;</span>, <span class="st">&#39;clearance_attempted&#39;</span>, <span class="st">&#39;pass_completed&#39;</span>, <span class="st">&#39;distance_covered&#39;</span>]]</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>defender_contributions <span class="op">=</span> master_df[master_df[<span class="st">&#39;position&#39;</span>] <span class="op">==</span> <span class="st">&#39;Defender&#39;</span>][<span class="st">&#39;defensive_contributions&#39;</span>]</span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a><span class="co"># splitting the dataset</span></span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(defender_features, defender_contributions, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a><span class="co"># building the model for defenders</span></span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a>model_defender <span class="op">=</span> LinearRegression()</span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a>model_defender.fit(X_train, y_train)</span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a>y_pred <span class="op">=</span> model_defender.predict(X_test)</span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-20"><a href="#cb43-20" aria-hidden="true" tabindex="-1"></a><span class="co"># evaluate the model</span></span>
<span id="cb43-21"><a href="#cb43-21" aria-hidden="true" tabindex="-1"></a>mse <span class="op">=</span> mean_squared_error(y_test, y_pred)</span>
<span id="cb43-22"><a href="#cb43-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Defender Position - Mean Squared Error:&quot;</span>, mse)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Defender Position - Mean Squared Error: 63.35822723321757
</code></pre>
</div>
</div>
<div class="cell markdown">
<h4
id="refinement-with-random-forest-and-feature-importance-analysis">Refinement
with Random Forest and Feature Importance Analysis:</h4>
<ul>
<li><strong>Random Forest Implementation</strong>: To address the high
MSE, we implemented a Random Forest Regressor, which is more adept at
handling non-linear relationships and interactions between
features.</li>
<li><strong>Feature Importance Analysis</strong>: Upon fitting the
Random Forest model, we conducted a feature importance analysis to
understand which features contribute most significantly to predicting
defensive contributions. This analysis revealed that
<code>minutes_played</code> was overwhelmingly the most significant
predictor, while other features like <code>distance_covered</code> and
<code>pass_completed</code> contributed less.</li>
</ul>
<h4 id="key-insights-and-next-steps">Key Insights and Next Steps:</h4>
<ul>
<li><strong>Feature Selection</strong>: The analysis indicates that
future model refinements could focus on features closely tied to active
gameplay minutes and possibly incorporate additional metrics such as
positional data or advanced defensive metrics not currently in the
dataset.</li>
<li><strong>Model Complexity</strong>: While the Random Forest model
provided more insight into feature importance, exploring other complex
models or feature engineering might yield better predictions.</li>
</ul>
<h4 id="conclusion">Conclusion:</h4>
<p>This exploration highlights the complexities of predictive modeling
in sports analytics, especially concerning defensive actions in soccer.
By iteratively refining our model and focusing on the most impactful
features, we gain better insights into what drives defensive
contributions on the field.</p>
<h4 id="visualization">Visualization:</h4>
<p>The feature importance graph visually represents the contribution of
each feature to the model, underscoring the dominance of minutes played
over other features.</p>
</div>
<div class="cell code" data-execution_count="766">
<div class="sourceCode" id="cb45"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> RandomForestRegressor</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a><span class="co"># setting up the Random Forest model</span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>rf_model <span class="op">=</span> RandomForestRegressor(n_estimators<span class="op">=</span><span class="dv">100</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate correlation with the target</span></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>correlation_matrix <span class="op">=</span> defender_features.corrwith(defender_contributions)</span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a><span class="co"># set a threshold for low correlations</span></span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>threshold <span class="op">=</span> <span class="fl">0.1</span></span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a><span class="co"># identify features with correlation below the threshold</span></span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a>low_corr_features <span class="op">=</span> correlation_matrix[correlation_matrix.<span class="bu">abs</span>() <span class="op">&lt;</span> threshold].index.tolist()</span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a><span class="co"># ensure only valid columns are dropped</span></span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a>valid_drop_columns <span class="op">=</span> [col <span class="cf">for</span> col <span class="kw">in</span> low_corr_features <span class="cf">if</span> col <span class="kw">in</span> defender_features.columns]</span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a><span class="co"># drop low correlation features</span></span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a>features <span class="op">=</span> defender_features.drop(columns<span class="op">=</span>valid_drop_columns)</span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-24"><a href="#cb45-24" aria-hidden="true" tabindex="-1"></a><span class="co"># fit the model</span></span>
<span id="cb45-25"><a href="#cb45-25" aria-hidden="true" tabindex="-1"></a>rf_model.fit(features, defender_contributions)</span>
<span id="cb45-26"><a href="#cb45-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-27"><a href="#cb45-27" aria-hidden="true" tabindex="-1"></a><span class="co"># get feature importances</span></span>
<span id="cb45-28"><a href="#cb45-28" aria-hidden="true" tabindex="-1"></a>importances <span class="op">=</span> rf_model.feature_importances_</span>
<span id="cb45-29"><a href="#cb45-29" aria-hidden="true" tabindex="-1"></a>feature_names <span class="op">=</span> features.columns</span>
<span id="cb45-30"><a href="#cb45-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-31"><a href="#cb45-31" aria-hidden="true" tabindex="-1"></a><span class="co"># plot feature importances</span></span>
<span id="cb45-32"><a href="#cb45-32" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb45-33"><a href="#cb45-33" aria-hidden="true" tabindex="-1"></a>sns.barplot(x<span class="op">=</span>importances, y<span class="op">=</span>feature_names)</span>
<span id="cb45-34"><a href="#cb45-34" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Feature Importances&#39;</span>)</span>
<span id="cb45-35"><a href="#cb45-35" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_ea965f5ca11141b9b8f78c89238b0122/ab9669c779f8cf3f5a8d427266c00a7646cb7c4f.png" /></p>
</div>
</div>
<section id="conclusion" class="cell markdown">
<h3>Conclusion</h3>
<p>This tutorial has journeyed through the multifaceted world of soccer
analytics, using data-driven techniques to uncover player performances,
predict outcomes, and gain insights that are not immediately obvious
through traditional statistics alone. Through our exploratory data
analysis, we identified key patterns and anomalies in player behaviors,
which informed our subsequent predictive modeling.</p>
<p>Our models for different player positions, from forwards to
defenders, highlighted the unique contributions of players to their
teams. The predictive models we developed help in forecasting player
impacts, offering valuable tools for team management and match
strategy.</p>
<p>The challenges encountered, particularly in feature selection and
model accuracy, underscore the complexity of sports analytics. However,
the iterative process of refining our models led to improved
understandings and refined strategies for data handling.</p>
<p>As soccer continues to evolve, so too will the methodologies used to
analyze it. This tutorial only scratches the surface. The future of
sports analytics will likely see a greater integration of biometric
data, enhanced player tracking, and real-time data utilization, further
revolutionizing how we understand and enjoy the beautiful game.</p>
<p>For those interested in further exploration, I encourage diving into
the resources provided and continuing to experiment with your own
datasets.</p>
</section>
<section id="extra-resources" class="cell markdown">
<h2>Extra Resources</h2>
<ol>
<li><p><strong>Soccermatics Course</strong>: This course teaches
advanced mathematics and statistics applied to soccer, providing a
deeper understanding of the game through data analysis. It's ideal for
those looking to dive into detailed soccer analytics. More details are
available on <a
href="https://soccermatics.readthedocs.io/en/latest/">Soccermatics</a>.</p></li>
<li><p><strong>DataCamp's Soccer Analytics Resources</strong>: DataCamp
offers various tutorials and classes that relate directly to data
science applications in sports, including soccer. These can help you
explore machine learning techniques and data analysis further. Explore
more on <a href="https://www.datacamp.com/">DataCamp's
website</a>.</p></li>
<li><p><strong>Friends of Tracking</strong>: This initiative involves
tutorials and discussions by data scientists from major soccer clubs and
academics. It's a resource for learning about the latest methods in
tracking data analysis in soccer. You can watch their sessions on the <a
href="https://www.youtube.com/channel/UCUB9C85WhFNCwBrjw3fTIzA">Friends
of Tracking YouTube channel</a>.</p></li>
</ol>
</section>
</body>
</html>
